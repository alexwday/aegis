test_suite:
  name: "Router Agent Comprehensive Performance Test Suite"
  description: "Complete performance and accuracy tests for the router agent with full coverage of routing decisions"
  version: "2.0"
  
  # Note: Latency is tracked for analysis but doesn't affect pass/fail
  # We expect different models to have different response times
    
  scenarios:
    # ====================
    # DIRECT RESPONSE SCENARIOS
    # ====================
    
    # Greetings & Social
    - id: "greeting_simple"
      name: "Simple Greeting"
      description: "Router should identify basic greetings as direct response"
      message: "Hello Aegis"
      expected:
        route: "direct_response"
      reasoning: "Simple greetings are conversational and don't require data research"
      tags: ["greeting", "direct"]
    
    - id: "greeting_morning"
      name: "Morning Greeting"
      description: "Router should identify time-based greetings as direct response"
      message: "Good morning! How are you today?"
      expected:
        route: "direct_response"
      reasoning: "Greetings with time references are still conversational interactions"
      tags: ["greeting", "direct"]
    
    - id: "farewell"
      name: "Farewell Message"
      description: "Router should handle goodbye messages directly"
      message: "Thanks for your help. Goodbye!"
      expected:
        route: "direct_response"
      reasoning: "Farewell messages don't require data lookup"
      tags: ["farewell", "direct"]
    
    # Gratitude & Acknowledgment
    - id: "gratitude"
      name: "Thank You Message"
      description: "Router should identify gratitude as direct response"
      message: "Thank you for your help with the analysis"
      expected:
        route: "direct_response"
      reasoning: "Expressions of gratitude don't require data lookup"
      tags: ["gratitude", "direct"]
    
    - id: "acknowledgment"
      name: "User Acknowledgment"
      description: "Router should handle acknowledgments directly"
      message: "Okay, I understand"
      expected:
        route: "direct_response"
      reasoning: "Simple acknowledgments are conversational"
      tags: ["acknowledgment", "direct"]
    
    # System & Capability Questions
    - id: "capability_question"
      name: "Capability Question"
      description: "Router should handle questions about capabilities directly"
      message: "What kind of financial data can you help me with?"
      expected:
        route: "direct_response"
      reasoning: "Questions about system capabilities are answered from knowledge, not data"
      tags: ["capability", "direct"]
    
    - id: "system_info"
      name: "System Information Request"
      description: "Router should handle system info requests directly"
      message: "What version of Aegis is this?"
      expected:
        route: "direct_response"
      reasoning: "System information doesn't require database queries"
      tags: ["system", "direct"]
    
    - id: "help_request"
      name: "Help Request"
      description: "Router should handle help requests directly"
      message: "Can you help me understand how to use this system?"
      expected:
        route: "direct_response"
      reasoning: "Help and guidance don't require data lookup"
      tags: ["help", "direct"]
    
    # Clarifications & Corrections
    - id: "clarification_for_data"
      name: "Clarification Leading to Data"
      description: "Router should fetch data after receiving clarification"
      conversation:
        - role: "user"
          content: "Show me the efficiency ratio"
        - role: "assistant"
          content: "Which bank's efficiency ratio would you like to see?"
        - role: "user"
          content: "RBC, the Royal Bank of Canada"
      expected:
        route: "research_workflow"
      reasoning: "User provided clarification for data request, now need to fetch the data"
      tags: ["clarification", "research"]
    
    - id: "clarification_not_ready"
      name: "Clarification But Not Ready"
      description: "User clarifies but delays data request"
      conversation:
        - role: "assistant"
          content: "Which bank are you interested in?"
        - role: "user"
          content: "I'm thinking about RBC, but first can you explain what metrics are available?"
      expected:
        route: "direct_response"
      reasoning: "User is asking for general explanation of metric types before data request"
      tags: ["clarification", "direct"]
    
    - id: "error_correction_conversational"
      name: "Conversational Error Correction"
      description: "Router should handle conversational corrections based on context"
      conversation:
        - role: "user"
          content: "I think RBC is the largest bank in Canada"
        - role: "assistant"
          content: "Yes, RBC is indeed the largest Canadian bank by market capitalization."
        - role: "user"
          content: "Sorry, I meant to ask about TD Bank, not RBC"
      expected:
        route: "direct_response"
      reasoning: "Correcting a conversational statement with no prior data context"
      tags: ["correction", "direct"]
    
    - id: "error_correction_data"
      name: "Data Request Error Correction"
      description: "Router should fetch new data after correction"
      conversation:
        - role: "user"
          content: "Show me RBC's efficiency ratio"
        - role: "assistant"
          content: "I'll retrieve RBC's efficiency ratio for you."
        - role: "user"
          content: "Wait, sorry, I meant TD Bank's efficiency ratio"
      expected:
        route: "research_workflow"
      reasoning: "User is correcting which data they want after a research context was established"
      tags: ["correction", "research"]
    
    # General Questions
    - id: "definition_request"
      name: "Definition Request"
      description: "Router should handle definition requests directly"
      message: "What does ROE stand for?"
      expected:
        route: "direct_response"
      reasoning: "General definitions can be provided with disclaimer about general knowledge"
      tags: ["definition", "direct"]
    
    - id: "explanation_request"
      name: "Concept Explanation"
      description: "Router should handle explanations directly"
      message: "Can you explain what an efficiency ratio means?"
      expected:
        route: "direct_response"
      reasoning: "General concept explanations provided with disclaimer about general knowledge"
      tags: ["explanation", "direct"]
    
    # ====================
    # RESEARCH WORKFLOW SCENARIOS
    # ====================
    
    # Specific Data Requests
    - id: "efficiency_ratio_request"
      name: "RBC Efficiency Ratio Request"
      description: "Router should identify specific data requests as research workflow"
      message: "Show me RBC's efficiency ratio for Q3 2024"
      expected:
        route: "research_workflow"
      reasoning: "Specific financial metrics require database queries and research"
      tags: ["data", "research", "rbc", "metrics"]
    
    - id: "revenue_request"
      name: "Revenue Data Request"
      description: "Router should route revenue requests to research"
      message: "What was TD Bank's revenue last quarter?"
      expected:
        route: "research_workflow"
      reasoning: "Revenue data requires database lookup"
      tags: ["revenue", "research", "td"]
    
    - id: "profit_request"
      name: "Profit Data Request"
      description: "Router should route profit requests to research"
      message: "Show me BMO's net profit for 2024"
      expected:
        route: "research_workflow"
      reasoning: "Profit data requires database queries"
      tags: ["profit", "research", "bmo"]
    
    # Comparisons
    - id: "comparison_request"
      name: "Bank Comparison Request"
      description: "Router should route comparative analysis to research"
      message: "Compare the ROE of TD Bank and BMO for the last quarter"
      expected:
        route: "research_workflow"
      reasoning: "Comparative analysis requires fetching data from multiple sources"
      tags: ["comparison", "research", "metrics"]
    
    - id: "multi_bank_comparison"
      name: "Multiple Bank Comparison"
      description: "Router should route multi-bank comparisons to research"
      message: "Show me efficiency ratios for all Big Six Canadian banks"
      expected:
        route: "research_workflow"
      reasoning: "Multi-entity comparisons require extensive data retrieval"
      tags: ["comparison", "research", "multiple"]
    
    - id: "year_over_year"
      name: "Year-over-Year Comparison"
      description: "Router should route YoY comparisons to research"
      message: "How did RBC's Q3 2024 performance compare to Q3 2023?"
      expected:
        route: "research_workflow"
      reasoning: "Time-based comparisons require historical data"
      tags: ["comparison", "research", "temporal"]
    
    # Trend Analysis
    - id: "trend_analysis"
      name: "Trend Analysis Request"
      description: "Router should route trend requests to research"
      message: "What's the trend in CIBC's net interest margin over the past year?"
      expected:
        route: "research_workflow"
      reasoning: "Trend analysis requires historical data retrieval"
      tags: ["trend", "research", "historical"]
    
    - id: "growth_analysis"
      name: "Growth Analysis Request"
      description: "Router should route growth analysis to research"
      message: "Show me the loan growth rate for Scotiabank over the last 5 quarters"
      expected:
        route: "research_workflow"
      reasoning: "Growth analysis requires multiple data points"
      tags: ["growth", "research", "historical"]
    
    # Financial Statements
    - id: "financial_statement"
      name: "Financial Statement Request"
      description: "Router should route financial statement requests to research"
      message: "Can you pull up Scotiabank's latest income statement?"
      expected:
        route: "research_workflow"
      reasoning: "Financial statements require document retrieval from databases"
      tags: ["statements", "research", "documents"]
    
    - id: "balance_sheet"
      name: "Balance Sheet Request"
      description: "Router should route balance sheet requests to research"
      message: "Show me National Bank's balance sheet for Q2 2024"
      expected:
        route: "research_workflow"
      reasoning: "Balance sheet data requires database lookup"
      tags: ["balance_sheet", "research", "documents"]
    
    - id: "cash_flow"
      name: "Cash Flow Statement Request"
      description: "Router should route cash flow requests to research"
      message: "I need to see RBC's cash flow statement"
      expected:
        route: "research_workflow"
      reasoning: "Cash flow statements require database retrieval"
      tags: ["cash_flow", "research", "documents"]
    
    # Benchmarking
    - id: "peer_benchmark_request"
      name: "Peer Comparison Request"
      description: "Router should route peer comparison requests to research"
      message: "How does National Bank's performance compare to other Canadian banks?"
      expected:
        route: "research_workflow"
      reasoning: "Peer comparisons require data from multiple banks"
      tags: ["benchmark", "research", "comparison"]
    
    - id: "peer_comparison"
      name: "Peer Group Comparison Request"
      description: "Router should route peer comparisons to research"
      message: "Compare TD Bank's metrics against other major Canadian banks"
      expected:
        route: "research_workflow"
      reasoning: "Peer comparisons require data from multiple banks"
      tags: ["peer", "research", "comparison"]
    
    # Calculations & Analysis
    - id: "calculation_request"
      name: "Calculation Request"
      description: "Router should identify calculation requests as research"
      message: "Calculate the 5-year average ROA for Canadian Imperial Bank"
      expected:
        route: "research_workflow"
      reasoning: "Calculations require data retrieval before computation"
      tags: ["calculation", "research", "metrics"]
    
    - id: "ratio_calculation"
      name: "Ratio Calculation Request"
      description: "Router should route ratio calculations to research"
      message: "What's the debt-to-equity ratio for BMO?"
      expected:
        route: "research_workflow"
      reasoning: "Ratio calculations require underlying data"
      tags: ["calculation", "research", "ratio"]
    
    # Reports & Summaries
    - id: "report_generation"
      name: "Report Generation Request"
      description: "Router should route report requests to research"
      message: "Generate a quarterly performance summary for all major Canadian banks"
      expected:
        route: "research_workflow"
      reasoning: "Report generation requires extensive data gathering and processing"
      tags: ["report", "research", "comprehensive"]
    
    - id: "executive_summary"
      name: "Executive Summary Request"
      description: "Router should route summary requests to research"
      message: "Create an executive summary of RBC's latest quarterly results"
      expected:
        route: "research_workflow"
      reasoning: "Summaries require data analysis and synthesis"
      tags: ["summary", "research", "comprehensive"]
    
    # Real-time & Latest Data
    - id: "latest_data"
      name: "Latest Data Request"
      description: "Router should route latest data requests to research"
      message: "What are the latest numbers for TD Bank?"
      expected:
        route: "research_workflow"
      reasoning: "Latest data requires database lookup"
      tags: ["latest", "research", "current"]
    
    - id: "current_metrics"
      name: "Current Metrics Request"
      description: "Router should route current metric requests to research"
      message: "Show me the current capital adequacy ratio for CIBC"
      expected:
        route: "research_workflow"
      reasoning: "Current metrics require real-time data access"
      tags: ["current", "research", "metrics"]
    
    # ====================
    # EDGE CASES & AMBIGUOUS SCENARIOS
    # ====================
    
    - id: "vague_numbers"
      name: "Vague Numbers Request"
      description: "Router should handle vague requests with research bias"
      message: "Show me the numbers"
      expected:
        route: "research_workflow"
      reasoning: "Vague requests likely need data but require clarification"
      tags: ["ambiguous", "vague"]
    
    - id: "mixed_greeting_data"
      name: "Greeting with Data Request"
      description: "Router should identify data requests even with greetings"
      message: "Hi there! Can you show me TD Bank's Q2 revenue figures?"
      expected:
        route: "research_workflow"
      reasoning: "Presence of specific data request overrides greeting for routing"
      tags: ["mixed", "greeting", "data"]
    
    - id: "contextual_followup"
      name: "Contextual Follow-up"
      description: "Router should consider conversation context for follow-ups"
      conversation:
        - role: "user"
          content: "Show me RBC's efficiency ratio"
        - role: "assistant"
          content: "RBC's efficiency ratio for Q3 2024 is 54.2%"
        - role: "user"
          content: "What about TD Bank?"
      expected:
        route: "research_workflow"
      reasoning: "Follow-up implies same type of data request for different entity"
      tags: ["followup", "contextual", "research"]
    
    - id: "followup_different_metric"
      name: "Follow-up for Different Metric"
      description: "Router should fetch new metric after showing previous data"
      conversation:
        - role: "user"
          content: "What's RBC's ROE?"
        - role: "assistant"
          content: "RBC's Return on Equity for Q3 2024 is 15.8%"
        - role: "user"
          content: "And their efficiency ratio?"
      expected:
        route: "research_workflow"
      reasoning: "User is asking for additional metric for same entity"
      tags: ["followup", "contextual", "research"]
    
    - id: "satisfied_after_data"
      name: "Satisfied After Receiving Data"
      description: "User acknowledges after receiving data"
      conversation:
        - role: "user"
          content: "Show me BMO's revenue"
        - role: "assistant"
          content: "BMO reported revenue of $7.8 billion for Q3 2024"
        - role: "user"
          content: "Perfect, that's what I needed"
      expected:
        route: "direct_response"
      reasoning: "User is acknowledging receipt of data, not requesting more"
      tags: ["acknowledgment", "after_data", "direct"]
    
    - id: "implicit_data_request"
      name: "Implicit Data Request"
      description: "Router should identify implicit data needs"
      message: "Is RBC doing better than last year?"
      expected:
        route: "research_workflow"
      reasoning: "Comparative questions require data to answer"
      tags: ["implicit", "research", "comparison"]
    
    - id: "question_as_data"
      name: "Question Requiring Data"
      description: "Router should identify questions needing data"
      message: "Which Canadian bank has the best efficiency ratio?"
      expected:
        route: "research_workflow"
      reasoning: "Superlative questions require data comparison"
      tags: ["question", "research", "comparison"]
    
    - id: "ambiguous_reference"
      name: "Ambiguous Reference"
      description: "Router should ask for clarification on vague references"
      message: "What was that thing we were talking about earlier?"
      expected:
        route: "direct_response"
      reasoning: "Vague reference without data context needs clarification"
      tags: ["ambiguous", "reference", "direct"]
    
    - id: "ambiguous_report_reference"
      name: "Ambiguous Report Reference"
      description: "Router should fetch data when report is mentioned"
      conversation:
        - role: "user"
          content: "I need the quarterly report for RBC"
        - role: "assistant"
          content: "I can help with RBC's quarterly data. Which quarter?"
        - role: "user"
          content: "The latest one please"
      expected:
        route: "research_workflow"
      reasoning: "User clarified they want the latest quarterly report"
      tags: ["ambiguous", "clarified", "research"]
    
    - id: "mixed_request"
      name: "Mixed Direct and Research"
      description: "Router should prioritize data needs in mixed requests"
      message: "Thanks for earlier. Now show me BMO's latest earnings"
      expected:
        route: "research_workflow"
      reasoning: "Data request takes priority over acknowledgment"
      tags: ["mixed", "priority", "research"]
    
    # ====================
    # PERFORMANCE STRESS TESTS
    # ====================
    
    - id: "long_conversation"
      name: "Long Conversation Context"
      description: "Router should handle long conversation history efficiently"
      conversation:
        - role: "user"
          content: "Hello, I need help with bank analysis"
        - role: "assistant"
          content: "I'd be happy to help with bank analysis. What would you like to know?"
        - role: "user"
          content: "I'm interested in Canadian banks"
        - role: "assistant"
          content: "Canadian banks are a great topic. Any specific metrics or banks?"
        - role: "user"
          content: "Yes, I want to look at profitability"
        - role: "assistant"
          content: "Profitability metrics include ROE, ROA, and net margins. Which interests you?"
        - role: "user"
          content: "Let's look at ROE for the big five banks"
      expected:
        route: "research_workflow"
      reasoning: "Despite long context, final request clearly needs data"
      tags: ["performance", "long_context"]
    
    - id: "complex_query"
      name: "Complex Multi-part Query"
      description: "Router should handle complex queries requiring research"
      message: "I need a comprehensive analysis of RBC including efficiency ratio, ROE, net interest margin, and how these compare to last year's figures, plus any notable trends"
      expected:
        route: "research_workflow"
      reasoning: "Complex multi-metric requests clearly require extensive research"
      tags: ["complex", "research", "comprehensive"]
    
    - id: "very_long_message"
      name: "Very Long Message"
      description: "Router should handle very long messages efficiently"
      message: "I've been looking at the Canadian banking sector and I'm particularly interested in understanding the performance of the major banks. I've heard that RBC is the largest, but I'm curious about how they compare to the other big banks like TD, BMO, Scotiabank, and CIBC. Specifically, I'd like to understand their relative efficiency ratios, return on equity, and net interest margins. I'm also interested in understanding how these metrics have changed over the past year and whether there are any notable trends. Additionally, if you have any information about their loan portfolios, deposit growth, or capital adequacy ratios, that would be helpful too."
      expected:
        route: "research_workflow"
      reasoning: "Long messages with multiple data requests need research"
      tags: ["performance", "long_message", "research"]
    
    # ====================
    # ERROR & BOUNDARY CASES
    # ====================
    
    - id: "empty_followup"
      name: "Empty Context Follow-up"
      description: "Router should handle follow-ups without clear context"
      message: "And what about the other one?"
      expected:
        route: "direct_response"
      reasoning: "Unclear references need clarification before data retrieval"
      tags: ["boundary", "unclear", "direct"]
    
    - id: "typo_request"
      name: "Request with Typos"
      description: "Router should handle typos in data requests"
      message: "Shwo me TDs eficiency ratioo"
      expected:
        route: "research_workflow"
      reasoning: "Despite typos, intent for data is clear"
      tags: ["typo", "research", "robustness"]
    
    - id: "mixed_language"
      name: "Mixed Language Request"
      description: "Router should handle mixed language in requests"
      message: "Show me the ROE pour la Banque Royale"
      expected:
        route: "research_workflow"
      reasoning: "Data request is clear despite mixed language"
      tags: ["language", "research", "robustness"]