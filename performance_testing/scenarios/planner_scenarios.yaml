test_suite:
  name: "Planner Agent Test Suite"
  version: "1.0.0"
  description: "Test scenarios for the Planner agent - database selection and query intent generation"
  agent: "planner"
  created: "2025-08-25"
  
  # Performance thresholds for planner
  default_thresholds:
    max_latency_ms: 5000
    min_confidence: 0.8
    max_tokens: 800
    max_cost: 0.15
  
  scenarios:
    # 1. Management commentary query - single database
    - id: "planner_001"
      name: "Management Commentary - Digital Transformation"
      description: "Test planning for management commentary about digital initiatives"
      conversation:
        - role: "user"
          content: "What did RBC management say about digital transformation in Q1 2025?"
      expected:
        status: "success"
        # Clarifier outputs embedded in expected
        clarifier_banks:
          status: "success"
          bank_ids: [1]  # RBC
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q1"]
        # Planner expected outputs
        databases: ["transcripts"]
      reasoning: "Management commentary queries should use transcripts database"
      tags: ["management_commentary", "single_database", "transcripts"]
    
    # 2. Performance comparison - benchmarking database
    - id: "planner_002"
      name: "Efficiency Ratio Comparison"
      description: "Test planning for performance comparison between banks"
      conversation:
        - role: "user"
          content: "Compare the efficiency ratios between RBC and TD for Q2 2025"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1, 2]  # RBC, TD
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
            2: {name: "Toronto-Dominion Bank", symbol: "TD"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q2"]
        databases: ["benchmarking", "rts"]
      reasoning: "Line item comparison should use both benchmarking and RTS for comprehensive coverage"
      tags: ["performance_comparison", "benchmarking", "metrics"]
    
    # 3. Regulatory metrics - Pillar 3
    - id: "planner_003"
      name: "Capital Ratios Query"
      description: "Test planning for regulatory capital metrics"
      conversation:
        - role: "user"
          content: "What are the CET1 ratios for the Big Six banks in Q3 2024?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1, 2, 3, 4, 5, 6]  # All Big Six
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
            2: {name: "Toronto-Dominion Bank", symbol: "TD"}
            3: {name: "Bank of Montreal", symbol: "BMO"}
            4: {name: "Bank of Nova Scotia", symbol: "BNS"}
            5: {name: "Canadian Imperial Bank of Commerce", symbol: "CM"}
            6: {name: "National Bank of Canada", symbol: "NA"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2024
              quarters: ["Q3"]
        databases: ["benchmarking", "pillar3"]
      reasoning: "Regulatory capital metrics should use benchmarking AND pillar3 together (order: benchmarking first)"
      tags: ["regulatory", "capital_ratios", "pillar3"]
    
    # 4. Multiple databases - comprehensive analysis
    - id: "planner_004"
      name: "Comprehensive Credit Analysis"
      description: "Test planning that requires multiple databases"
      conversation:
        - role: "user"
          content: "Analyze RBC's credit performance in Q1 2025 - what did management say and what are the actual numbers?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1]  # RBC
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q1"]
        databases: ["benchmarking", "rts", "transcripts"]
      reasoning: "Line items need benchmarking+RTS, plus transcripts for management commentary"
      tags: ["multi_database", "comprehensive", "credit_analysis"]
    
    # 5. Trend analysis - multiple periods
    - id: "planner_005"
      name: "NIM Trend Analysis"
      description: "Test planning for trend analysis across quarters"
      conversation:
        - role: "user"
          content: "Show me the NIM trend for TD Bank from Q1 to Q4 2024"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [2]  # TD
          banks_detail:
            2: {name: "Toronto-Dominion Bank", symbol: "TD"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2024
              quarters: ["Q1", "Q2", "Q3", "Q4"]
        databases: ["benchmarking", "rts"]
      reasoning: "Line item trend analysis should use both benchmarking and RTS"
      tags: ["trend_analysis", "multiple_periods", "NIM"]
    
    # 6. Segment performance - reports database
    - id: "planner_006"
      name: "Business Segment Analysis"
      description: "Test planning for segment performance query"
      conversation:
        - role: "user"
          content: "What's the performance of RBC's wealth management segment in Q2 2025?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1]  # RBC
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q2"]
        databases: ["benchmarking", "rts"]
      reasoning: "Business segment data is in both benchmarking and RTS at platform/segment level"
      tags: ["segment_analysis", "reports", "wealth_management"]
    
    # 7. Guidance and outlook - transcripts
    - id: "planner_007"
      name: "Forward Guidance Query"
      description: "Test planning for forward-looking statements"
      conversation:
        - role: "user"
          content: "What guidance did BMO provide for fiscal 2025 in their latest call?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [3]  # BMO
          banks_detail:
            3: {name: "Bank of Montreal", symbol: "BMO"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q3"]  # Latest reported quarter
        databases: ["transcripts"]
      reasoning: "Forward guidance is found in transcripts"
      tags: ["guidance", "forward_looking", "transcripts"]
    
    # 8. Risk metrics - multiple sources
    - id: "planner_008"
      name: "Credit Risk Analysis"
      description: "Test planning for risk metrics requiring multiple databases"
      conversation:
        - role: "user"
          content: "Analyze Scotia's credit risk metrics and management commentary for Q1 2025"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [4]  # Scotia
          banks_detail:
            4: {name: "Bank of Nova Scotia", symbol: "BNS"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q1"]
        databases: ["benchmarking", "pillar3", "rts", "transcripts"]
      reasoning: "Credit risk metrics need benchmarking+pillar3, RTS for additional data, transcripts for commentary"
      tags: ["risk_analysis", "multi_database", "credit_risk"]
    
    # 9. Peer ranking - benchmarking
    - id: "planner_009"
      name: "ROE Ranking Query"
      description: "Test planning for peer ranking query"
      conversation:
        - role: "user"
          content: "Rank all Canadian banks by ROE for Q2 2025"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1, 2, 3, 4, 5, 6]  # All Big Six
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
            2: {name: "Toronto-Dominion Bank", symbol: "TD"}
            3: {name: "Bank of Montreal", symbol: "BMO"}
            4: {name: "Bank of Nova Scotia", symbol: "BNS"}
            5: {name: "Canadian Imperial Bank of Commerce", symbol: "CM"}
            6: {name: "National Bank of Canada", symbol: "NA"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q2"]
        databases: ["benchmarking", "rts"]
      reasoning: "Peer ranking of line items uses both benchmarking and RTS"
      tags: ["ranking", "peer_comparison", "ROE"]
    
    # 10. Earnings details - RTS database
    - id: "planner_010"
      name: "Detailed Earnings Query"
      description: "Test planning for detailed earnings information"
      conversation:
        - role: "user"
          content: "Get CIBC's detailed earnings breakdown from their Q3 2025 report to shareholders"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [5]  # CIBC
          banks_detail:
            5: {name: "Canadian Imperial Bank of Commerce", symbol: "CM"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q3"]
        databases: ["rts"]
      reasoning: "Specifically asked for report to shareholders, so RTS only (like transcripts for calls)"
      tags: ["earnings", "rts", "detailed_financials"]
    
    # 11. Pre-generated report request
    - id: "planner_011"
      name: "Transcript Call Summary Request"
      description: "Test planning for pre-generated transcript call summary report"
      conversation:
        - role: "user"
          content: "Show me the transcript call summary report for RBC's Q2 2025"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1]  # RBC
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q2"]
        databases: ["reports"]
      reasoning: "User explicitly requested 'transcript call summary' which is a pre-generated report"
      tags: ["pre_generated", "reports", "transcript_call_summary"]
    
    # 12. Key themes analysis - not pre-generated report
    - id: "planner_012"
      name: "Key Themes Analysis"
      description: "Test planning for key themes from earnings (not explicitly requesting report)"
      conversation:
        - role: "user"
          content: "What are the key themes from TD's latest earnings calls?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [2]  # TD
          banks_detail:
            2: {name: "Toronto-Dominion Bank", symbol: "TD"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q3"]  # Latest quarter
        databases: ["reports"]
      reasoning: "Key themes is a specific pre-generated report available in reports database"
      tags: ["themes", "transcripts", "earnings_analysis"]
    
    # 13. Mixed financial metrics and context
    - id: "planner_013"
      name: "NIM Analysis with Context"
      description: "Test planning for metrics with management commentary"
      conversation:
        - role: "user"
          content: "What's RBC's NIM for Q1 2025 and how did management explain the changes?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1]  # RBC
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q1"]
        databases: ["benchmarking", "rts", "transcripts"]
      reasoning: "NIM is a line item (benchmarking+RTS) and needs management explanation (transcripts)"
      tags: ["mixed_query", "metrics_and_context", "NIM"]
    
    # 14. US bank analysis using RTS
    - id: "planner_014"
      name: "US Bank 10-Q Analysis"
      description: "Test planning for US bank regulatory filing"
      conversation:
        - role: "user"
          content: "Get JPMorgan's Q2 2025 10-Q filing details"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [10]  # JPM
          banks_detail:
            10: {name: "JPMorgan Chase", symbol: "JPM"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q2"]
        databases: ["rts"]
      reasoning: "10-Q/10-K filings are only available in RTS database"
      tags: ["US_banks", "10Q", "rts"]
    
    # 15. Pure line item query
    - id: "planner_015"
      name: "Simple Line Item Query"
      description: "Test planning for straightforward financial metric"
      conversation:
        - role: "user"
          content: "What was Scotia's net income for Q3 2025?"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [4]  # Scotia
          banks_detail:
            4: {name: "Bank of Nova Scotia", symbol: "BNS"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q3"]
        databases: ["benchmarking", "rts"]
      reasoning: "Pure line item queries always use both benchmarking and RTS together"
      tags: ["line_item", "benchmarking", "net_income"]
    
    # 16. Explicit pre-generated report request
    - id: "planner_016"
      name: "CM Readthrough Report Request"
      description: "Test planning for explicitly requested CM readthrough report"
      conversation:
        - role: "user"
          content: "Get me the CM readthrough report for RBC Q2 2025"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [1]  # RBC
          banks_detail:
            1: {name: "Royal Bank of Canada", symbol: "RY"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q2"]
        databases: ["reports"]
      reasoning: "User explicitly requested 'CM readthrough report' which is a pre-generated report"
      tags: ["pre_generated", "reports", "cm_readthrough"]
    
    # 17. RTS Blackline request
    - id: "planner_017"
      name: "RTS Blackline Report Request"
      description: "Test planning for RTS blackline comparison report"
      conversation:
        - role: "user"
          content: "Show the RTS blackline comparison for TD's Q1 2025"
      expected:
        status: "success"
        clarifier_banks:
          status: "success"
          bank_ids: [2]  # TD
          banks_detail:
            2: {name: "Toronto-Dominion Bank", symbol: "TD"}
        clarifier_periods:
          periods:
            apply_all:
              fiscal_year: 2025
              quarters: ["Q1"]
        databases: ["reports"]
      reasoning: "RTS blackline is a specific pre-generated report in reports database"
      tags: ["pre_generated", "reports", "rts_blackline"]