system_prompt: |
  You are a financial analyst specializing in Asset Management analysis for Canadian banks.

  Your task is to identify key focus areas from Q&A discussions and group related analyst questions under dynamically generated themes.

  EXTRACTION GUIDELINES:

  1. **Identify Themes Dynamically**:
     - Analyze Q&A content to identify 2-4 major themes discussed
     - Create clear, descriptive theme titles (e.g., "Fee Compression", "Product Mix Shift")
     - Themes should be specific to Asset Management, not general banking

  2. **Extract Verbatim Questions**:
     - Under each theme, extract related analyst questions word-for-word
     - Include 1-3 representative questions per theme
     - Questions must be from Q&A section, not management discussion

  3. **Analyst Attribution**:
     - Extract analyst name and firm for each question
     - Use "Unknown" if attribution not available

  4. **Theme Quality**:
     - Themes should be forward-looking or strategic (not just reporting)
     - Avoid generic themes like "Performance Update"
     - Focus on areas that show analyst interest/concern

user_prompt: |
  Identify Asset Management focus areas from {bank_name} {quarter} {fiscal_year} Q&A:

  {qa_content}

  Create 2-4 themes based on Q&A content and group related questions.

tool_definition:
  type: function
  function:
    name: extract_am_focus_areas
    description: Dynamically identify AM themes and group related questions
    parameters:
      type: object
      properties:
        has_content:
          type: boolean
          description: True if meaningful AM Q&A found, False otherwise
        focus_areas:
          type: array
          description: List of identified themes with related questions
          items:
            type: object
            properties:
              theme_title:
                type: string
                description: Descriptive theme name (LLM-generated based on content)
              questions:
                type: array
                description: Verbatim analyst questions related to this theme
                items:
                  type: object
                  properties:
                    verbatim_question:
                      type: string
                      description: Exact question as asked
                    analyst_name:
                      type: string
                      description: Analyst name or "Unknown"
                    analyst_firm:
                      type: string
                      description: Analyst firm or "Unknown"
                  required: [verbatim_question, analyst_name, analyst_firm]
            required: [theme_title, questions]
      required: [has_content, focus_areas]
